<!DOCTYPE html>
<html>
<head>
<meta name="charset" content="UTF-8">
<title>Bitcoin Private Key Generator :p</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://code.jquery.com/jquery.js"></script>
<link rel="stylesheet" href="bootstrap.min.css">
<script src="bootstrap.min.js"></script>
<script src="bitcoinjs-min.js"></script>
<script type="text/javascript">
var data = [
   ['Test', 'Test'],
];
var count = 0;
var myVar = setInterval(run, 1);
function run() {
	var randArr = new Uint8Array(32)
	window.crypto.getRandomValues(randArr)
	var privateKeyBytes = []
	for (var i = 0; i < randArr.length; ++i) {
		privateKeyBytes[i] = randArr[i]
	}
	var eckey = new Bitcoin.ECKey(privateKeyBytes)
	eckey.compressed = true
	var address = eckey.getBitcoinAddress().toString()
	var privateKeyBytesCompressed = privateKeyBytes.slice(0)
	privateKeyBytesCompressed.push(0x01)
	var privateKeyWIFCompressed = new Bitcoin.Address(privateKeyBytesCompressed)
	privateKeyWIFCompressed.version = 0x80
	privateKeyWIFCompressed = privateKeyWIFCompressed.toString()
	var newdata = [[address, privateKeyWIFCompressed]];
	data.push(newdata);
	count += 1;
	console.log(count);
}
function download_csv() {
	clearInterval(myVar);
	var csv = 'Address, Key\n';
    	data.forEach(function(row) {
            	csv += row.join(',');
            	csv += "\n";
    	});
 
    	console.log(csv);
    	var hiddenElement = document.createElement('a');
    	hiddenElement.href = 'data:text/csv;charset=utf-8,' + encodeURI(csv);
    	hiddenElement.target = '_blank';
    	hiddenElement.download = 'addresses.csv';
    	hiddenElement.click();
}	
</script>
<button onclick="download_csv()">Download CSV</button> 
</html>
